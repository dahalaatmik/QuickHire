{% extends 'dashboard/base_dashboard.html' %}

{% block title %}Analytics{% endblock %}
{% block breadcrumb %}Analytics{% endblock %}
{% block topbar_actions %}
<select class="settings-input" id="time-range" style="width:130px;">
    <option value="7d">Last 7 Days</option>
    <option value="30d" selected>Last 30 Days</option>
    <option value="90d">Last 90 Days</option>
</select>
<button class="btn-outline-sm" id="export-btn"><i data-feather="download"></i> Export</button>
<button class="icon-btn"><i data-feather="bell"></i></button>
{% endblock %}

{% block page_content %}
<!-- KPI Stats -->
<div class="stats-grid">
    <div class="stat-card">
        <span class="stat-icon"><i data-feather="bar-chart-2"></i></span>
        <div class="stat-label">Applications</div>
        <div class="stat-value">214</div>
        <div class="stat-change">↑ 18% vs prev period</div>
    </div>
    <div class="stat-card green">
        <span class="stat-icon"><i data-feather="check-circle"></i></span>
        <div class="stat-label">Conversion Rate</div>
        <div class="stat-value">12.4%</div>
        <div class="stat-change">↑ 2.1% improvement</div>
    </div>
    <div class="stat-card amber">
        <span class="stat-icon"><i data-feather="clock"></i></span>
        <div class="stat-label">Avg Time to Hire</div>
        <div class="stat-value">18 days</div>
        <div class="stat-change down">↓ 3 days faster</div>
    </div>
    <div class="stat-card purple">
        <span class="stat-icon"><i data-feather="dollar-sign"></i></span>
        <div class="stat-label">Cost per Hire</div>
        <div class="stat-value">$2,340</div>
        <div class="stat-change">↓ $180 saved</div>
    </div>
</div>

<div class="two-col">
    <!-- Applications over time (bar chart) -->
    <div class="card-panel">
        <h3>Applications Over Time</h3>
        <div class="bar-chart" id="app-chart"></div>
    </div>

    <!-- Candidates by department (horizontal bars) -->
    <div class="card-panel">
        <h3>Applications by Department</h3>
        <div id="dept-breakdown"></div>
    </div>
</div>

<div class="two-col">
    <!-- Funnel / Pipeline -->
    <div class="card-panel">
        <h3>Hiring Funnel</h3>
        <div id="funnel-chart"></div>
    </div>

    <!-- Top skills in demand -->
    <div class="card-panel">
        <h3>Top Skills in Demand</h3>
        <div id="skills-demand"></div>
    </div>
</div>

<!-- Recent hires table -->
<div class="section-heading" style="margin-top:var(--spacing-xl);"><h2>Recent Hires</h2></div>
<div class="data-table-wrap">
    <table>
        <thead><tr>
            <th>Candidate</th><th>Role</th><th>Department</th><th>Match Score</th><th>Time to Hire</th><th>Hired On</th>
        </tr></thead>
        <tbody id="hires-tbody"></tbody>
    </table>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/analytics.js') }}"></script>
{% endblock %}
