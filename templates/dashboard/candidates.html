{% extends 'dashboard/base_dashboard.html' %}

{% block title %}Candidate Pool{% endblock %}
{% block breadcrumb %}Candidate Pool{% endblock %}

{% block page_content %}
<!-- Stats -->
<div class="stats-grid">
    <div class="stat-card">
        <span class="stat-icon"><i data-feather="users"></i></span>
        <div class="stat-label">Total Candidates</div>
        <div class="stat-value">{{ total }}</div>
    </div>
    <div class="stat-card green">
        <span class="stat-icon"><i data-feather="user-check"></i></span>
        <div class="stat-label">Shortlisted</div>
        <div class="stat-value">{{ shortlisted }}</div>
    </div>
    <div class="stat-card amber">
        <span class="stat-icon"><i data-feather="clock"></i></span>
        <div class="stat-label">Pending Review</div>
        <div class="stat-value">{{ pending }}</div>
    </div>
    <div class="stat-card purple">
        <span class="stat-icon"><i data-feather="check-circle"></i></span>
        <div class="stat-label">Hired</div>
        <div class="stat-value">{{ hired }}</div>
    </div>
</div>

<!-- Candidates List -->
<div class="section-heading">
    <h2>All Candidates</h2>
</div>

{% if candidates %}
<div class="data-table-wrap">
    <table>
        <thead>
            <tr>
                <th>Candidate</th>
                <th>Applied For</th>
                <th>Score</th>
                <th>Tier</th>
                <th>Status</th>
                <th>Date</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for c in candidates %}
            <tr>
                <td>
                    <a href="{{ url_for('candidates.candidate_detail', candidate_id=c.id) }}" style="text-decoration:none;color:var(--color-text-high);font-weight:500;">
                        {{ c.name or c.resume_filename }}
                    </a>
                    {% if c.email %}
                    <div style="font-size:var(--font-size-xs);color:var(--color-text-disabled);">{{ c.email }}</div>
                    {% endif %}
                </td>
                <td style="font-size:var(--font-size-sm);color:var(--color-text-low);">
                    <a href="{{ url_for('jobs.job_detail', job_id=c.job_id) }}" style="text-decoration:none;color:var(--color-primary);">{{ c.job.title }}</a>
                </td>
                <td>
                    {% if c.score %}
                    <span style="font-weight:600;color:{% if c.score.overall_score >= 75 %}var(--color-success){% elif c.score.overall_score >= 50 %}var(--color-warning){% else %}var(--color-danger){% endif %};">{{ c.score.overall_score|int }}%</span>
                    {% else %}
                    <span style="color:var(--color-text-disabled);">—</span>
                    {% endif %}
                </td>
                <td>
                    {% if c.score %}
                    <span class="badge {% if c.score.tier == 'Strong' %}badge-active{% elif c.score.tier == 'Medium' %}badge-pending{% else %}badge-rejected{% endif %}">{{ c.score.tier }}</span>
                    {% else %}
                    <span class="badge badge-pending">Pending</span>
                    {% endif %}
                </td>
                <td>
                    <span class="badge {% if c.status == 'hired' %}badge-active{% elif c.status == 'shortlisted' %}badge-active{% elif c.status == 'rejected' %}badge-rejected{% elif c.status == 'interview_sent' %}badge-active{% else %}badge-pending{% endif %}">{{ c.status }}</span>
                </td>
                <td style="font-size:var(--font-size-xs);color:var(--color-text-disabled);">{{ c.created_at.strftime('%b %d') if c.created_at else '—' }}</td>
                <td>
                    <a href="{{ url_for('candidates.candidate_detail', candidate_id=c.id) }}" class="btn-outline-sm" style="padding:4px 10px;font-size:var(--font-size-xs);">
                        <i data-feather="eye" style="width:12px;height:12px;"></i> View
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="card-panel" style="padding:var(--spacing-2xl);text-align:center;color:var(--color-text-disabled);">
    <i data-feather="users" style="width:40px;height:40px;margin-bottom:var(--spacing-sm);"></i>
    <h3 style="color:var(--color-text-high);font-size:var(--font-size-lg);margin-bottom:var(--spacing-xs);">No candidates yet</h3>
    <p style="margin-bottom:var(--spacing-lg);">Create a job and upload resumes to see candidates here.</p>
    <a href="{{ url_for('jobs.job_create') }}" class="btn-primary"><i data-feather="plus"></i> Create a Job</a>
</div>
{% endif %}
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', () => { if (window.feather) feather.replace(); });
</script>
{% endblock %}
