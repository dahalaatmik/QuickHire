{% extends 'dashboard/base_dashboard.html' %}

{% block title %}Job Postings{% endblock %}
{% block breadcrumb %}Job Postings{% endblock %}
{% block topbar_actions %}
<a href="{{ url_for('jobs.job_create') }}" class="btn-outline-sm"><i data-feather="plus"></i> New Job</a>
{% endblock %}

{% block page_content %}
<!-- Stats row -->
<div class="stats-grid">
    <div class="stat-card">
        <span class="stat-icon"><i data-feather="briefcase"></i></span>
        <div class="stat-label">Total Postings</div>
        <div class="stat-value">{{ total_postings }}</div>
    </div>
    <div class="stat-card green">
        <span class="stat-icon"><i data-feather="check-circle"></i></span>
        <div class="stat-label">Active</div>
        <div class="stat-value">{{ open_now }}</div>
        <div class="stat-change">Accepting resumes</div>
    </div>
    <div class="stat-card amber">
        <span class="stat-icon"><i data-feather="edit-3"></i></span>
        <div class="stat-label">Draft</div>
        <div class="stat-value">{{ draft_count }}</div>
    </div>
    <div class="stat-card red">
        <span class="stat-icon"><i data-feather="x-circle"></i></span>
        <div class="stat-label">Closed</div>
        <div class="stat-value">{{ closed_count }}</div>
    </div>
</div>

<!-- Jobs List -->
<div class="section-heading">
    <h2>All Postings</h2>
</div>

{% if jobs %}
<div class="data-table-wrap">
    <table>
        <thead>
            <tr>
                <th>Job Title</th>
                <th>Category</th>
                <th>Candidates</th>
                <th>Created</th>
                <th>Status</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for job in jobs %}
            <tr>
                <td>
                    <a href="{{ url_for('jobs.job_detail', job_id=job.id) }}" style="text-decoration:none;color:var(--color-text-high);font-weight:600;">
                        {{ job.title }}
                    </a>
                </td>
                <td style="color:var(--color-text-low);font-size:var(--font-size-sm);">{{ job.field_category or '—' }}</td>
                <td>
                    <span style="font-weight:500;">{{ job.candidates|length }}</span>
                </td>
                <td style="font-size:var(--font-size-sm);color:var(--color-text-disabled);">{{ job.created_at.strftime('%b %d, %Y') if job.created_at else '—' }}</td>
                <td>
                    <span class="badge {% if job.status == 'active' %}badge-active{% elif job.status == 'draft' %}badge-pending{% else %}badge-rejected{% endif %}">{{ job.status }}</span>
                </td>
                <td>
                    <a href="{{ url_for('jobs.job_detail', job_id=job.id) }}" class="btn-outline-sm" style="padding:4px 10px;font-size:var(--font-size-xs);">
                        <i data-feather="eye" style="width:12px;height:12px;"></i> View
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="card-panel" style="padding:var(--spacing-2xl);text-align:center;color:var(--color-text-disabled);">
    <i data-feather="briefcase" style="width:40px;height:40px;margin-bottom:var(--spacing-sm);"></i>
    <h3 style="color:var(--color-text-high);font-size:var(--font-size-lg);margin-bottom:var(--spacing-xs);">No job postings yet</h3>
    <p style="margin-bottom:var(--spacing-lg);">Create your first job posting to start screening candidates with AI.</p>
    <a href="{{ url_for('jobs.job_create') }}" class="btn-primary"><i data-feather="plus"></i> Create Your First Job</a>
</div>
{% endif %}
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', () => { if (window.feather) feather.replace(); });
</script>
{% endblock %}
