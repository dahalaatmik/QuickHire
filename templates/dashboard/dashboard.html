{% extends 'dashboard/base_dashboard.html' %}

{% block title %}Dashboard{% endblock %}
{% block breadcrumb %}Dashboard{% endblock %}
{% block topbar_actions %}
<a href="{{ url_for('jobs.job_create') }}" class="btn-outline-sm"><i data-feather="plus"></i> Create Job</a>
{% endblock %}

{% block page_content %}
<!-- Stat Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <span class="stat-icon"><i data-feather="briefcase"></i></span>
        <div class="stat-label">Active Jobs</div>
        <div class="stat-value">{{ active_jobs }}</div>
        <div class="stat-change">{{ total_jobs }} total</div>
    </div>
    <div class="stat-card green">
        <span class="stat-icon"><i data-feather="users"></i></span>
        <div class="stat-label">Total Candidates</div>
        <div class="stat-value">{{ total_candidates }}</div>
    </div>
    <div class="stat-card amber">
        <span class="stat-icon"><i data-feather="clock"></i></span>
        <div class="stat-label">Pending Review</div>
        <div class="stat-value">{{ pending_review }}</div>
        <div class="stat-change down">Awaiting action</div>
    </div>
    <div class="stat-card purple">
        <span class="stat-icon"><i data-feather="check-circle"></i></span>
        <div class="stat-label">Interviews Scheduled</div>
        <div class="stat-value">{{ interviews_scheduled }}</div>
    </div>
</div>

<!-- Two col: Quick Actions + Activity -->
<div class="two-col">
    <div>
        <div class="section-heading"><h2>Quick Actions</h2></div>
        <div class="card-panel" style="padding:var(--spacing-lg);">
            <a href="{{ url_for('jobs.job_create') }}" class="quick-action-link" style="display:flex;align-items:center;gap:var(--spacing-md);padding:var(--spacing-md);border-radius:8px;text-decoration:none;color:var(--color-text-high);border:1px solid var(--color-border);margin-bottom:var(--spacing-sm);transition:border-color var(--transition-fast);">
                <i data-feather="plus-circle" style="color:var(--color-primary);"></i>
                <div>
                    <div style="font-weight:600;">Create New Job</div>
                    <div style="font-size:var(--font-size-xs);color:var(--color-text-low);">Post a job description and start screening</div>
                </div>
            </a>
            <a href="{{ url_for('jobs.jobs_list') }}" class="quick-action-link" style="display:flex;align-items:center;gap:var(--spacing-md);padding:var(--spacing-md);border-radius:8px;text-decoration:none;color:var(--color-text-high);border:1px solid var(--color-border);margin-bottom:var(--spacing-sm);transition:border-color var(--transition-fast);">
                <i data-feather="briefcase" style="color:var(--color-primary);"></i>
                <div>
                    <div style="font-weight:600;">View All Jobs</div>
                    <div style="font-size:var(--font-size-xs);color:var(--color-text-low);">Manage your job postings and candidates</div>
                </div>
            </a>
            <a href="{{ url_for('candidates.candidates_list') }}" class="quick-action-link" style="display:flex;align-items:center;gap:var(--spacing-md);padding:var(--spacing-md);border-radius:8px;text-decoration:none;color:var(--color-text-high);border:1px solid var(--color-border);transition:border-color var(--transition-fast);">
                <i data-feather="users" style="color:var(--color-primary);"></i>
                <div>
                    <div style="font-weight:600;">Candidate Pool</div>
                    <div style="font-size:var(--font-size-xs);color:var(--color-text-low);">View all candidates across jobs</div>
                </div>
            </a>
        </div>
    </div>
    <div>
        <div class="section-heading"><h2>Recent Candidates</h2></div>
        <div class="card-panel" style="padding:0;">
            {% if recent_candidates %}
            <div style="max-height:300px;overflow-y:auto;">
                {% for c in recent_candidates %}
                <a href="{{ url_for('candidates.candidate_detail', candidate_id=c.id) }}" style="display:flex;align-items:center;gap:var(--spacing-md);padding:var(--spacing-sm) var(--spacing-md);border-bottom:1px solid var(--color-border);text-decoration:none;color:inherit;transition:background var(--transition-fast);" class="activity-item">
                    <div class="avatar-sm">{{ (c.name or 'U')[0] }}{{ (c.name or 'U').split(' ')[-1][0] if c.name and ' ' in c.name else '' }}</div>
                    <div style="flex:1;min-width:0;">
                        <div style="font-weight:500;color:var(--color-text-high);font-size:var(--font-size-sm);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">{{ c.name or c.resume_filename }}</div>
                        <div style="font-size:var(--font-size-xs);color:var(--color-text-low);">{{ c.job.title }} &middot; {{ c.status }}</div>
                    </div>
                    {% if c.score %}
                    <span class="badge {% if c.score.tier == 'Strong' %}badge-active{% elif c.score.tier == 'Medium' %}badge-pending{% else %}badge-rejected{% endif %}">{{ c.score.overall_score|int }}%</span>
                    {% else %}
                    <span class="badge badge-pending">Pending</span>
                    {% endif %}
                </a>
                {% endfor %}
            </div>
            {% else %}
            <div style="padding:var(--spacing-xl);text-align:center;color:var(--color-text-disabled);">
                <i data-feather="inbox" style="width:32px;height:32px;margin-bottom:var(--spacing-sm);"></i>
                <p>No candidates yet. Create a job and upload resumes to get started.</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}
